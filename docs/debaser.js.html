<!DOCTYPE html>

<html lang="en">
<head>
	<meta charset="utf-8">
	<title>angular-debaser Source: /Volumes/samara/projects/boneskull/angular-debaser/build/docs/debaser.js</title>

	<!--[if lt IE 9]>
	<script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->
	<link type="text/css" rel="stylesheet" href="styles/sunlight.default.css">

	<link type="text/css" rel="stylesheet" href="styles/site.spacelab.css">

</head>

<body>
<div class="container-fluid">
	<div class="navbar navbar-fixed-top navbar-inverse">
		<div class="navbar-inner">
			<a class="brand" href="index.html">angular-debaser</a>
			<ul class="nav">
				
				<li class="dropdown">
					<a href="namespaces.list.html" class="dropdown-toggle" data-toggle="dropdown">Namespaces<b
						class="caret"></b></a>

					<ul class="dropdown-menu ">
						
						<li>
							<a href="window.debaser.html">window.debaser</a>
						</li>
						

					</ul>
				</li>
				
				<li class="dropdown">
					<a href="modules.list.html" class="dropdown-toggle" data-toggle="dropdown">Modules<b
						class="caret"></b></a>

					<ul class="dropdown-menu ">
						
						<li>
							<a href="debaser.html">decipher.debaser</a>
						</li>
						

					</ul>
				</li>
				
				<li class="dropdown">
					<a href="classes.list.html" class="dropdown-toggle" data-toggle="dropdown">Classes<b
						class="caret"></b></a>

					<ul class="dropdown-menu ">
						
						<li>
							<a href="decipher.debaser.loadAction.html">decipher.debaser.loadAction</a>
						</li>
						
						<li>
							<a href="debaser.Config.html">decipher.debaser.Config</a>
						</li>
						
						<li>
							<a href="loadAction.Action.html">loadAction.Action</a>
						</li>
						

					</ul>
				</li>
				
				<li class="dropdown">
					<a href="global.html" class="dropdown-toggle" data-toggle="dropdown">Global<b
						class="caret"></b></a>

					<ul class="dropdown-menu ">
						
						<li>
							<a href="global.html#debaser">debaser</a>
						</li>
						

					</ul>
				</li>
				
				<li class="dropdown">
					<a href="externals.list.html" class="dropdown-toggle" data-toggle="dropdown">Externals<b
						class="caret"></b></a>

					<ul class="dropdown-menu ">
						
						<li>
							<a href="external-angular.html">angular</a>
						</li>
						

					</ul>
				</li>
				
			</ul>
		</div>
	</div>

	<div class="row-fluid">

		
			<div class="span12">
				
				<div id="main">
					


		<h1 class="page-title">Source: /Volumes/samara/projects/boneskull/angular-debaser/build/docs/debaser.js</h1>
    
<section>
	<article>
		<pre
			class="sunlight-highlight-javascript linenums">/**
 * @file **{@link https://github.com/decipherinc/angular-debaser|angular-debaser}** - *Just a better way to test AngularJS apps*
 * @version 0.2.3 (2014-07-19)
 * @copyright 2014 Decipher, Inc.
 * @license MIT
 */
/**
 * @module decipher.debaser
 */
'use strict';

/**
 * @typedef {Array.&lt;String>} Annotation
 * @private
 * @description Annotation for AngularJS factories.
 */

/**
 * @external angular
 * @see {@link http://angularjs.org}
 */

/**
 * @namespace {function} window.debaser
 * @see {@link debaser}
 */

/**
 * @description Default options
 * @typedef {object} DebaserOptions
 * @property {boolean} [debugEnabled=false] Enable debug log messages?
 * @property {boolean} [autoScope=true] Enable auto-scope functionality when using {@link ng.$controller}?
 * @property {boolean} [skipConfigs=true] Enable stubbing of `config()` blocks?
 * @property {string} [defaultName=__default__] Default name of default Debaser instance; useless
 * @global
 */
var DEFAULT_OPTS = {
  debugEnabled: false,
  autoScope: true,
  skipConfigs: true,
  defaultName: '__default__'
};

/**
 * Attaches {@link debaser} and {@link debase} to the `window` object.
 * Registers `setup()`/`teardown()` or `beforeEach()`/`afterEach()` functions to retrieve the current spec.
 */
var install = function install() {

  window.debaser = debaser;
  window.debase = debase;

  // TODO document these
  (window.beforeEach || window.setup)(function () {
    debaser.$$currentSpec = this;
  });

  (window.afterEach || window.teardown)(function () {
    delete debaser.$$currentSpec;
  });

  debaser.bootstrap(runConfig);
};

/**
 * @description Whether or not we are currently running in a spec.
 * @returns {boolean}
 */
var hasCurrentSpec = function hasCurrentSpec() {
  return !!debaser.$$currentSpec;
};

/**
 * @description Provides a {@link Debaser} object with which you can stub dependencies easily.
 * @param {(String|Object)} [name=DebaserOptions.name] Optional name of Debaser.  Only useful if using
 * multiple instances.  If omitted, this is considered the `opts` parameter.
 * @param {DebaserOptions} [options={}] Options to modify angular-debaser's behavior; see {@link DebaserOptions}.
 * @example
 *
 * // Defaults
 * var d = debaser({
 *  debugEnabled: false,
 *  autoScope: true
 *  skipConfigs: true
 * });
 *
 * // Named
 * var d = debaser('foo', {
 *  debugEnabled: false,
 *  autoScope: true
 *  skipConfigs: true
 * });
 *
 * @returns {Debaser}
 * @global
 * @public
 */
var debaser = function debaser(name, options) {
  var debaserSetup,
    defaultName = DEFAULT_OPTS.defaultName,
    getInstance = debaser.getInstance,
    hasInstance = debaser.hasInstance,
    injector,
    instance,
    opts,
    Debaser;

  // setup args
  if (angular.isObject(name)) {
    opts = name;
    name = null;
  } else {
    opts = options;
  }

  opts = opts || {};
  debaserSetup = debaser._configure(opts);

  // bootstrap the debaserSetup and decipher.debaser module, so we can get to the debaserFactory.
  angular.mock.module(debaserSetup, 'decipherDebaser');

  // if we are not given a name and the default instance exists, return it so we don't re-instantiate.
  // eliminate debaser.__globalInstance TODO why?
  if (!name &amp;&amp; hasInstance(defaultName)) {
    debaser.__globalInstance = null;
    return getInstance(defaultName);
  }

  // injector to retrieve Debaser class.
  injector = angular.injector(['ng', debaserSetup, 'decipherDebaser']);
  //noinspection JSUnusedAssignment
  Debaser = injector.get('debaserDebaser');

  // init new Debaser instance or get existing if given name.  eliminate debaser.__globalInstance
  // since it's no longer applicable.
  if (name) {
    if (!hasInstance(name)) {
      debaser.__debasers[name] = new Debaser(name);
    }
    debaser.__globalInstance = null;
    return getInstance(name);
  }

  // (this is a new Debaser with the default name)
  instance = new Debaser();

  // if we're not in a beforeEach() then we're not in a spec.  call this the global, default instance.
  debaser.__globalInstance = !hasCurrentSpec() ? instance : null;

  return instance;
};

/**
 * @description Provides an anonymous AngularJS module to set up some initial values before {@link module:decipher.debaser} is bootstrapped.
 * @param {DebaserOptions} [options] Override {@link DebaserOptions} with this object.
 * @returns {function}
 */
var configure = function configure(options) {
  /**
   * @description
   * Provides two constants, `debaserOptions`, which is set to a {@link DebaserOptions}
   * object when calling {@link debaser}; and `decipher.debaser.__runConfig` which is internal data
   * to be used when calling {@link debase} or {@link Debaser#debase}.
   * @param {auto.$provide} $provide {@link https://code.angularjs.org/1.2.20/docs/api/auto/service/$provide.html|auto.$provide docs}
   * @property {Annotation} $inject
   */
  var debaserSetup = function debaserSetup($provide) {
    $provide.constant('debaserOptions',
      angular.extend({}, DEFAULT_OPTS, options));
    $provide.constant('debaserRunConfig', runConfig);
  };
  debaserSetup.$inject = ['$provide'];
  return debaserSetup;
};

/**
 * @description Retrieve an existing Debaser instance by name.
 * @param {string} name Name of instance
 * @returns {Debaser}
 */
var getInstance = function getInstance(name) {
  return debasers[name];
};

/**
 * @description Whether or not an instance with name exists.
 * @param {string} name Name of instance
 * @returns {boolean}
 */
var hasInstance = function hasInstance(name) {
  return !!getInstance(name);
};

/**
 * @description Mapping of {@link Debaser#name}s to {@link Debaser} instances, for potential retrieval later.  **Exposed for unit testing.**
 * @type {Object.&lt;String,Debaser>}
 * @private
 * @memberof window.debaser
 */
var debasers = debaser.__debasers = {};

/**
 * @description Run configurations.  Mapping of {@link Config#_id} to {@link Config} objects. **Exposed for unit testing**
 * @todo test
 * @type {Object.&lt;String,Config>}
 * @memberof window.debaser
 * @private
*/
var runConfig = debaser.__runConfig = {};

/**
 * @description Default instance if we are not running in a spec; presumably created in a `before()` block.  **Exposed for unit testing**
 * @type {?Debaser}
 * @todo test
 * @memberof window.debaser
 * @private
 */
var globalInstance = debaser.__globalInstance = null;

/**
 * @description Convenience method.  Retrieves the default instance (whatever that may be) and runs `debase()` on it.
 * @example
 *
 * before(function() {
 *   debaser()
 *     .func('foo')
 *     .object('bar')
 * });
 *
 * beforeEach(debase);
 *
 * // above equivalent to:
 *
 * var d;
 * before(function() {
 *   d = debaser()
 *     .func('foo')
 *     .object('bar')
 * });
 *
 * beforeEach(function() {
 *   d.debase();
 * });
 * @returns {(function|Debaser)}
 * @param {string} [name] Name of {@link Debaser} instance to call {@link Debaser#debase} upon.
 * @memberof window.debaser
 * @public
 */
var debase = function debase(name) {
  var defaultName = DEFAULT_OPTS.defaultName,

    /**
     * @description Calls {@link Debaser#debase} with proper persistance options.  Unlike {@link Debaser#debase}, will return a {@link Debaser} instance.
     * @memberof globalHelpers
     * @function callDebase
     * @returns {Debaser}
     * @throws Invalid {@link Debaser} name
     * @throws If {@link debaser} was never called
     */
    callDebase = function callDebase() {
      var d;

      if (!name || !angular.isString(name)) {
        if (!hasInstance(defaultName)) {
          if (globalInstance) {
            return globalInstance.debase({persist: true});
          }
          throw new Error('debaser: no Debaser initialized!');
        }
        name = defaultName;
      }
      else if (!hasInstance(name)) {
        throw new Error('debaser: cannot find Debaser instance with name "' + name + '"');
      }
      d = debaser.getInstance(name);
      // TODO not sure if persist value is correct.
      d.debase({
        persist: name !== defaultName
      });
      return d;
    };

  return hasCurrentSpec() ? callDebase() : callDebase;
};

install();

/* global runConfig */

'use strict';

/**
 * @description Main module for angular-debaser.  You are unlikely to interface with this module directly.  See {@link debaser} to get started.
 */
angular.module('decipher.debaser', [])

/**
 * @name debaserRunConfig
 * @memberof module:decipher.debaser
 * @borrows debaser.__runConfig
 */
  .constant('debaserRunConfig', runConfig)
  .config(['debaserOptions', '$logProvider', '$provide',
    function config(options, $logProvider, $provide) {
      // older versions of angular-mocks do not implement this function.
      if (angular.isFunction($logProvider.debugEnabled)) {
        $logProvider.debugEnabled(options.debugEnabled);
      }
      // likewise, maybe no debug() either
      $provide.decorator('$log', ['$delegate', function ($delegate) {
        $delegate.debug = $delegate.debug || options.debugEnabled ? $delegate.log : angular.noop;
        return $delegate;
      }]);
    }
  ]);

'use strict';

angular.module('decipher.debaser')
  .factory('debaserLoadAction', function loadActionFactory() {

  /**
   * @description Creates a new Action object.
   * @param {object} action Raw action object
   * @param {function} [action.callback=angular.noop] Function to call with the return value of the main Function to call
   * @param {object} [action.object] Object containing main Function to call
   * @param {function} action.func Main Function to call
   * @param {object} [action.context=null] Context to call main Function with
   * @param {array} [action.args=[]] Context to
   * @class Represents a serializable action.
   * @memberof loadAction
   */
  var Action = function Action(action) {
    angular.extend(this, action);
    this.callback = this.callback || angular.noop;
    this.context = this.context || null;
  };

  /**
   *
   * @returns {Action#assemble~action}
   */
  Action.prototype.assemble = function assemble() {
    /**
     * @description Executes an assembled function
     * @memberof! Action#assemble
     * @inner
     */
    return function action() {
      this.callback(!this.object ? this.func.apply(this.context, this.args) :
        this.object[this.func].apply(this.context, this.args));
    }.bind(this);
  };

  /**
   * @description Accepts a {@link Config} object, constructs and returns {@link Action} instances from its `actions` property
   * @constructs Action
   * @name decipher.debaser.loadAction
   */
  return function loadAction(cfg) {
    return cfg.actions.map(function (action) {
      return new Action(action);
    });
  };
});

'use strict';

angular.module('decipher.debaser').factory('debaserAspect',
  ['debaserSuperpowers', 'debaserBehavior',
    function aspectFactory(superpowers, Behavior) {

      var Aspect = function Aspect(name, parent) {
        this.name = name;
        this.parent = parent;
        this._id = Aspect._id++;
      };

      Aspect._id = 0;

      Aspect._DEFAULT_NAME = 'base';

      Object.defineProperties(Aspect.prototype, {
        name: {
          get: function getName() {
            return this._name;
          },
          set: function setName(name) {
            this._dirty = this._isDirty(name, '_name');
            this._name = name || Aspect._DEFAULT_NAME;
          }
        },
        parent: {
          get: function getParent() {
            return this._parent;
          },
          set: function setParent(parent) {
            this._dirty = this._isDirty(parent, '_parent');
            this._parent = parent;
          }
        },
        proto: {
          get: function getProto() {
            var dirty = this._dirty;
            if (!this._proto || dirty) {
              this._initProto();
            }
            this._dirty = false;
            return this._proto;
          },
          set: function setProto(proto) {
            this._proto = proto;
          }
        },
        behavior: {
          get: function getBehavior() {
            var dirty = this._dirty;
            if (!this._behavior || dirty) {
              this._initBehavior();
            }
            this._dirty = false;
            return this._behavior;
          },
          set: function setBehavior(behavior) {
            this._behavior = behavior;
          }
        },
        config: {
          get: function getConfig() {
            return this.behavior.config;
          },
          set: function setConfig(config) {
            this.behavior.config = config;
          }
        }
      });

      Aspect.prototype._initProto = function _initProto() {
        var o;
        if (this._proto &amp;&amp; !this._dirty) {
          return;
        }
        o = {};
        if (this.parent) {
          angular.extend(o, this.parent.proto);
        }
        angular.forEach(superpowers, function (fn, name) {
          if (name.charAt(0) !== '$' &amp;&amp;
            fn.$aspect.indexOf(this._name) !== -1) {
            o[name] = this.createProxy(fn, name);
          }
        }, this);
        this._proto = o;
      };

      Aspect.prototype._initBehavior = function _initBehavior() {
        if (this._behavior &amp;&amp; !this._dirty) {
          return;
        }
        this._behavior = new Behavior(angular.extend(this._behavior || {},
            this.parent &amp;&amp; this.parent.isAspectOf(this.name) &amp;&amp;
            this.parent.behavior), this.name);
      };

      Aspect.prototype.flush = function flush() {
        return this.behavior.flush();
      };

      Aspect.prototype._isDirty = function _isDirty(value, prop) {
        return (value &amp;&amp; value !== this[prop]) || (!value &amp;&amp; this[prop]);
      };

      Aspect.prototype.createProxy = function createProxy(fn, name) {
        var proxy;
        /**
         * @this Debaser
         * @returns {Debaser|*}
         * @todo trim fat
         */
        proxy = function proxy() {
          var current_aspect = this.$$aspect,
              inherits = current_aspect.isAspectOf(name),
              retval = this,
              aspect,
              result;

          if (!inherits &amp;&amp; current_aspect.name !== 'base') {
            this.$enqueue();
          }
          aspect = this.$aspect(fn.$name || name);
          result = fn.apply(aspect.config, arguments);

          if (angular.isArray(result)) {
            aspect.behavior.enqueue(result);
          }
          else if (result) {
            retval = result;
          }
          return retval;
        };
        return proxy;
      };
      Aspect.prototype.createProxy.cache = {};

      Aspect.prototype.isAspectOf = function isAspectOf(name) {
        return name !== 'base' &amp;&amp; superpowers[name] &amp;&amp;
          superpowers[name].$aspect.indexOf(this.name) !== -1;
      };

      return Aspect;
    }
  ]);

'use strict';

angular.module('decipher.debaser').factory('debaserBehavior',
  ['debaserConfig', function $behaviorFactory(Config) {
    var Behavior = function Behavior(o, aspect_name) {
      angular.extend(this, o);
      this._aspect_name = aspect_name;
      this._id = Behavior._id++;
    };

    Behavior._id = 0;

    Behavior.prototype.enqueue = function enqueue(calls) {
      this.queue.push.apply(this.queue, calls);
    };

    Behavior.prototype.flush = function flush() {
      return this.queue.map(function (action) {
        return action.assemble();
      });
    };

    Object.defineProperties(Behavior.prototype, {
      queue: {
        get: function getQueue() {
          if (!this._queue) {
            this._queue = [];
          }
          return this._queue;
        },
        set: function setQueue(queue) {
          this._queue = queue || [];
        }
      },
      config: {
        get: function getConfig() {
          if (!this._config) {
            this._config = new Config(this._aspect_name);
          }
          return this._config;
        },
        set: function setConfig(config) {
          this._config = config || new Config(this._aspect_name);
        }
      }
    });

    return Behavior;
  }]);

'use strict';

angular.module('decipher.debaser').factory('debaserConfig',
  function configFactory() {

    /**
     * @name Config
     * @static
     * @param {(object|string)} o Raw {@link Behavior} configuration object, or {@link Aspect} name
     * @class
     * @param {string} [aspect_name] Name of {@link Aspect} this configuration belongs to
     */
    var Config = function Config(o, aspect_name) {
      if (angular.isString(o)) {
        aspect_name = o;
      }
      else {
        angular.extend(this, o);
      }
      this._aspect_name = aspect_name;
      this._callbacks = [];
      this._cb_idx = 0;
      this._id = Config._id++;
      this.actions = this.actions || [];
    };

    Config._id = 0;

    Config.prototype.addAction = function addAction(opts) {
      if (!opts) {
        throw new Error('$debaser: addCall() expects call options');
      }
      opts.callback = opts.callback || this.runner();
      opts.context =
        angular.isDefined(opts.context) ? opts.context : opts.object || null;
      this.actions.push(opts);
    };

    Config.prototype.next = function next() {
      if (this._callbacks[this._cb_idx]) {
        this._callbacks[this._cb_idx++].apply(this, arguments);
      } else {
        this.done();
      }
    };

    Config.prototype.done = function done() {
      this._cb_idx = 0;
    };

    Config.prototype.chain = function chain(fn) {
      this._callbacks.push(function debaserCallbackProxy() {
        this.next(fn.apply(this, arguments));
      }.bind(this));
    };

    Config.prototype.runner = function runner() {
      return function run() {
        this.next.apply(this, arguments);
      }.bind(this);
    };

    Config.prototype.isChained = function isChained() {
      return !!this._callbacks.length;
    };

    return Config;

  });

'use strict';

angular.module('decipher.debaser').factory('debaserDebaser',
  ['$log', 'debaserAspect', 'debaserOptions',
    function debaserFactory($log, Aspect, options) {

      var defaultName = options.defaultName;

      /**
       * @name Debaser
       * @private
       * @memberof decipher.debaser
       * @param name
       * @constructor
       */
      var Debaser = function Debaser(name) {
        if (!angular.isString(name)) {
          name = options.defaultName;
        }
        this.$name = name;
        this.$queue = [];
        this.$aspect('base');
        if (name !== defaultName) {
          $log.debug('$debaser: created Debaser instance with name "' + name + '"');
        } else {
          $log.debug('$debaser: created singleton Debaser instance');
        }
      };

      Debaser.prototype.$aspect = function $aspect(name) {
        var current_aspect = this.$$aspect,
            aspect,
            proto;
        if (angular.isUndefined(name)) {
          name = current_aspect.name;
        }
        if (current_aspect) {
          proto = current_aspect.proto;
          Object.keys(proto).forEach(function (name) {
            delete this[name];
          }, this);
        }
        aspect = new Aspect(name, current_aspect);
        angular.extend(this, aspect.proto);
        this.$$aspect = aspect;
        return aspect;
      };

      Debaser.prototype.$enqueue = function $enqueue() {
        var current_aspect = this.$$aspect;
        if (current_aspect) {
          this.$queue.push.apply(this.$queue, current_aspect.flush());
        }
      };

      Debaser.autoScopeProvider = function ($provide) {
        $provide.decorator('$controller',
          ['$rootScope', '$delegate', function ($rootScope, $delegate) {
            return function (name, locals) {
              locals = locals || {};
              if (!locals.$scope) {
                locals.$scope = $rootScope.$new();
              }
              $delegate(name, locals);
              return locals.$scope;
            };
          }]);
      };
      Debaser.autoScopeProvider.$inject = ['$provide'];

      Debaser.prototype.debase = function debase(opts) {
        opts = opts || {};
        this.$enqueue();
        this.$queue.forEach(function (fn) {
          fn();
        });
        if (!opts.persist) {
          this.$queue = [];
        }
        this.$aspect('base');
        if (options.autoScope) {
          angular.mock.module(Debaser.autoScopeProvider);
        }
      };

      return Debaser;
    }]);


'use strict';

/**
 * @todo split me up
 */
angular.module('decipher.debaser').factory('debaserSuperpowers',
  ['debaserLoadAction', '$window', 'debaserRunConfig', '$log',
    'debaserOptions',
    function superpowersFactory(loadAction, $window, $runConfig, $log, options) {

      var sinon = $window.sinon,
          SINON_EXCLUDE = [
            'create',
            'resetBehavior',
            'isPresent'
          ],

          // better way to do this?
          isSinon = function isSinon(value) {
            return value.displayName === 'stub' ||
              value.displayName === 'spy';
          },

          debaserConstantCallback = function debaserConstantCallback(module) {
            if (this.name &amp;&amp; this.stub &amp;&amp; module &amp;&amp; module.constant) {
              return module.constant(this.name, this.stub);
            }
          },

          module,
          withDep,
          withDeps,
          func,
          object,
          withFunc,
          withObject;

      module = function module(name, deps) {
        var real_module, i;
        if (!name) {
          name = 'dummy-' + module.$id++;
        }
        if (!angular.isString(name)) {
          throw new Error('$debaser: module() expects a string');
        }
        this.module = name;
        this.module_dependencies = [];
        if (deps) {
          if (!angular.isArray(deps)) {
            throw new Error('$debaser: module() expects array or undefined as second parameter');
          }
          superpowers.withDeps.call(this, deps);
        }
        try {
          real_module = angular.module(name);
          if (options.skipConfigs &amp;&amp; real_module) {
            i = real_module._invokeQueue.length;
            while (i--) {
              if (real_module._invokeQueue[i][0] === '$injector' &amp;&amp;
                real_module._invokeQueue[i][1] === 'invoke') {
                real_module._invokeQueue.splice(i, 1);
              }
            }
          }
        }
        catch (e) {
        }
        this.addAction({
          object: angular,
          func: 'module',
          args: !real_module ? [this.module, this.module_dependencies] : [this.module]
        });
        this.addAction({
          object: angular.mock,
          func: 'module',
          args: [this.module]
        });
        return loadAction(this);
      };
      module.$aspect = ['base'];
      module.$id = 0;

      withDep = function withDep() {
        if (!arguments.length) {
          return $log.debug('$debaser: ignoring empty call to withDep()');
        }
        Array.prototype.slice.call(arguments).forEach(function (arg) {
          if (!angular.isString(arg)) {
            throw new Error('$debaser: withDep() expects one or more strings');
          }
        });
        this.module_dependencies.push.apply(this.module_dependencies,
          arguments);
      };
      withDep.$aspect = ['module'];

      withDeps = function withDeps(arr) {
        if (!arr) {
          return $log.debug('$debaser: ignoring empty call to withDeps()');
        }
        if (!angular.isArray(arr)) {
          throw new Error('$debaser: withDeps() expects an array');
        }
        withDep.apply(this, arr);
      };
      withDeps.$aspect = ['module'];

      func = function func(name) {
        var args = Array.prototype.slice.call(arguments, 1);
        if (!name) {
          return $log.debug('$debaser: ignoring empty call to func()');
        }
        if (!angular.isString(name)) {
          throw new Error('$debaser: func() expects a name');
        }
        this.func = sinon &amp;&amp; sinon.stub ? sinon.stub.apply(sinon, args) :
          function debaserStub() {
          };
        return object.call(this, name, this.func);
      };
      func.$aspect = ['base'];

      object = function object(name, base) {
        if (!name) {
          return $log.debug('$debaser: ignoring empty call to object()');
        }
        if (!angular.isString(name)) {
          throw new Error('$debaser: object() expects a name');
        }
        if (base &amp;&amp; !angular.isFunction(base) &amp;&amp; !angular.isObject(base)) {
          throw new Error('$debaser: object() second param should be an ' +
            'Object or undefined');
        }
        if (!this.stub) {
          if (!angular.isObject(base) &amp;&amp; !angular.isFunction(base)) {
            base = {};
          }
          if (angular.isObject(base)) {
            this.stub =
                sinon &amp;&amp; sinon.stub &amp;&amp; !isSinon(base) ? sinon.stub(base) :
              base;
          } else {
            this.stub = base;
          }
        }
        if (!this.isChained()) {
          this.name = name;
          this.component = 'value';
          this.provider = function provider($provide, $config) {
            var cfg = $config[provider._id];
            $provide[cfg.component](cfg.name, cfg.stub);
          };
          // angularjs hates to inject identical functions.
          // this makes them no longer identical.
          this.provider.toString = function toString() {
            return 'debaserProvider-' + this._id.toString();
          }.bind(this);
          this.provider._id = this._id;
          this.provider.$inject = ['$provide', 'debaserRunConfig'];
          this.addAction(
            {
              object: angular.mock,
              func: 'module',
              args: [this.provider]
            }
          );
          $runConfig[this._id] = this;
          return loadAction(this);
        }
      };
      object.$aspect = ['base'];

      // todo: add warnings here
      withFunc = function withFunc(name) {
        var args = Array.prototype.slice.call(arguments, 1);
        if (angular.isObject(this.stub)) {
          this.func = sinon &amp;&amp; sinon.stub ? sinon.stub.apply(sinon, args) :
            function debaserStub() {
            };
          this.stub[name] = this.func;
        } else {
          this.name = name;
          this.chain(debaserConstantCallback.bind(this));
          func.apply(this, arguments);
        }
      };
      withFunc.$aspect = ['module', 'object', 'withObject'];

      withObject = function withObject(name) {
        this.name = name;
        this.chain(debaserConstantCallback.bind(this));
        object.apply(this, arguments);
      };
      withObject.$aspect = ['module'];

      var superpowers = {
        func: func,
        module: module,
        object: object,
        withDep: withDep,
        withDeps: withDeps,
        withFunc: withFunc,
        withObject: withObject,

        // exposed for testing
        $SINON_EXCLUDE: SINON_EXCLUDE
      };

      angular.forEach(superpowers, function (fn, name) {
        if (!fn.$name) {
          fn.$name = name;
        }
      });

      if (sinon) {
        angular.forEach(sinon.stub, function (fn, name) {
          if (angular.isFunction(fn) &amp;&amp; SINON_EXCLUDE.indexOf(name) === -1) {
            var sinonProxy = function sinonProxy() {
              var retval = fn.apply(this.func, arguments);
              if (retval &amp;&amp; retval.stub &amp;&amp; retval.stub.func) {
                retval.end = function debaserEnd() {
                  return this;
                }.bind(this);
                return retval;
              }
            };
            sinonProxy.$aspect = ['func', 'withFunc'];
            superpowers[name] = sinonProxy;
          }
        });
      }

      return superpowers;
    }]);
</pre>
	</article>
</section>





				</div>

				<div class="clearfix"></div>
				<footer>
					
					
		<span class="copyright">
		angular-debaser Copyright &copy; 2014 Decipher, Inc.
		</span>
					<br />
					
		<span class="jsdoc-message">
		Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.3.0-alpha9</a>
		on Sat Jul 19th 2014 using the <a
			href="https://github.com/terryweiss/docstrap">DocStrap template</a>.
		</span>
				</footer>
			</div>

			
			<br clear="both">
		</div>

	</div>
	<!--<script src="scripts/sunlight.js"></script>-->
	<script src="scripts/docstrap.lib.js"></script>
	<script src="scripts/bootstrap-dropdown.js"></script>
	<script src="scripts/toc.js"></script>

	<script>
		$( function () {
			$( "[id*='$']" ).each( function () {
				var $this = $( this );

				$this.attr( "id", $this.attr( "id" ).replace( "$", "__" ) );
			} );

			$( "#toc" ).toc( {
				anchorName  : function ( i, heading, prefix ) {
					return $( heading ).attr( "id" ) || ( prefix + i );
				},
				selectors   : "h1,h2,h3,h4",
				showAndHide : false,
				scrollTo    : "100px"
			} );

			$( "#toc>ul" ).addClass( "nav nav-pills nav-stacked" );
			$( "#main span[id^='toc']" ).addClass( "toc-shim" );
			$( '.dropdown-toggle' ).dropdown();
//			$( ".tutorial-section pre, .readme-section pre" ).addClass( "sunlight-highlight-javascript" ).addClass( "linenums" );

			$( ".tutorial-section pre, .readme-section pre" ).each( function () {
				var $this = $( this );

				var example = $this.find( "code" );
				exampleText = example.html();
				var lang = /{@lang (.*?)}/.exec( exampleText );
				if ( lang && lang[1] ) {
					exampleText = exampleText.replace( lang[0], "" );
					example.html( exampleText );
					lang = lang[1];
				} else {
					lang = "javascript";
				}

				if ( lang ) {

					$this
						.addClass( "sunlight-highlight-" + lang )
						.addClass( "linenums" )
						.html( example.html() );

				}
			} );

			Sunlight.highlightAll( {
				lineNumbers : true,
				showMenu : true,
				enableDoclinks : true
			} );
		} );
	 </script>



	<!--Navigation and Symbol Display-->
	


	<!--Google Analytics-->
	

</body>
</html>
