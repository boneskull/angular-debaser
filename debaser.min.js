/*! angular-debaser - v0.1.0 - 2014-06-26
* https://github.com/decipherinc/angular-debaser
* Copyright (c) 2014 Decipher, Inc.; Licensed MIT */

!function(a,b){"use strict";var c={debugEnabled:!1};b.module("decipher.debaser",[]).config(["decipher.debaser.options","$logProvider","$provide",function(a,c,d){b.isFunction(c.debugEnabled)&&c.debugEnabled(a.debugEnabled),d.decorator("$log",["$delegate",function(a){return a.debug||b.noop}])}]).factory("$debaser",["$log","$aspect",function(a,c){var d=function e(d,f){b.isString(d)||(f=d,d=e.DEFAULT_NAME),this.$name=d,this.$$injector=f,this.$Aspect=c(),this.$queue=[],this.$aspect("base"),a(d!==e.DEFAULT_NAME?'$debaser: created Debaser instance with name "'+d+'"':"$debaser: created singleton Debaser instance")};return d.DEFAULT_NAME="__default__",d.prototype.$aspect=function(a){var c,d,e=this.$$aspect;a&&(e&&(c=e.name(),"base"!==c&&c!==a&&(Object.keys(e.proto()).forEach(function(a){delete this[a]},this),this.$enqueue())),d=this.$Aspect.create(a,e),b.extend(this,d.proto()),this.$$aspect=d)},d.prototype.$injector=function(){if(this.$$injector)return this.$$injector;throw new Error("$debaser: no local injector")},d.prototype.$enqueue=function(){var a=this.$$aspect;a&&this.$queue.push.apply(this.$queue,a.flush())},d.prototype.debase=function(){this.$enqueue(),this.$queue.forEach(function(a){a()}),this.$queue=[],this.$aspect("base")},d}]);var d=function(a){return function(d){d.constant("decipher.debaser.options",b.extend({},c,a))}};d.$inject=["$provide"],a.debaser=function(c,e){var f,g,h,i=a.debaser.$$debasers;if(b.isObject(c)&&(e=c,c=null),!c&&i.__default__)throw new Error("$debaser: global debaser already registered!");return e=e||{},h=b.injector(["ng",d(e),"decipher.debaser"]),f=h.get("$debaser"),c?(i[c]||(i[c]=new f(c,h)),i[c]):(i.__default__=g=new f(h),a.debase=g.debase.bind(g),g)},a.debaser.$$debasers={}}(window,window.angular),function(a){"use strict";a.module("decipher.debaser").factory("$aspect",["$superpowers",function(b){var c=function(a,b){this.$name=a,this.$parent=b,this.createProxy.cache=b?b.createProxy.cache:{},this.$behavior=b?b.$behavior:[],this.$behavior.$config=this.$behavior.$config||{},this.$proto=this.proto()};return c.prototype.behavior=function(){return this.$behavior},c.prototype.proto=function(){var c={};return this.$proto?this.$proto:(a.forEach(b,function(a,b){a.$aspect===this.$name&&(c[b]=this.createProxy(a,b))},this),this.$parent&&a.extend(c,this.$parent.proto()),c)},c.prototype.flush=function(){var a=this.$behavior,b=a.map(function(a){return a.deserialize()});return b},c.prototype.name=function(){return this.$name},c.prototype.createProxy=function(a,b){var c,d,e,f=this.createProxy.cache;return f[b]?f[b]:(d=this.$behavior,e=d.$config,c=function(){var c=a.apply(e,arguments);return c&&d.push.apply(d,c),this.$aspect(b),this},f[b]=c,c)},c.create=function(a,b){var d,e=c.create.cache;return e[a]?e[a]:(d=new c(a,b),e[a]=d,d)},function(){return c.create.cache={},c}}])}(window.angular),function(a){"use strict";a.module("decipher.debaser").factory("$call",function(){var b=function(a,b,c,d){this.object=a,this.fn_name=b,this.args=c,this.ctx=d||null};return b.prototype.deserialize=function(){var a=this.object,b=this.fn_name,c=this.args,d=this.ctx;return function(){a[b].apply(d,c)}},function(){return a.isArray(arguments[0])?Array.prototype.slice.call(arguments).map(function(a){return new b(a[0],a[1],a[2],a[3])}):[new b(arguments[0],arguments[1],arguments[2],arguments[3])]}})}(window.angular),function(a){"use strict";a.module("decipher.debaser").factory("$superpowers",["$call","$window",function(b,c){var d=c.sinon,e=function(c){if(c){if(!a.isString(c))throw new Error("$debaser: module() expects a string");return this.module=c,this.module_dependencies=[],b([a,"module",[this.module,this.module_dependencies],a],[a.mock,"module",[c],a.mock])}};e.$aspect="base";var f=function(){arguments.length&&(Array.prototype.slice.call(arguments).forEach(function(b){if(!a.isString(b))throw new Error("$debaser: withDep() expects one or more strings")}),this.module_dependencies.push.apply(this.module_dependencies,arguments))};f.$aspect="module";var g=function(b){if(b){if(!a.isArray(b))throw new Error("$debaser: withDeps() expects an array");i.withDep.apply(this,b)}};g.$aspect="module";var h=function(c){if(c){if(!a.isString(c))throw new Error("$debaser: func() expects a name");return this.stub=d.stub(),this.name=c,this.component="value",this.provider=function(a){a[this.component](this.name,this.stub)}.bind(this),this.provider.$inject=["$provide"],b(a.mock,"module",[this.provider],a.mock)}};h.$aspect="base";var i={module:e,withDep:f,withDeps:g,func:h};return a.forEach(d.stub,function(a,b){var c=function(){a.apply(this.stub,arguments)};c.$aspect="func",i[b]=c}),i}])}(window.angular);
//# sourceMappingURL=debaser.min.js.map