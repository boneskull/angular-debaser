/*! angular-debaser - v0.1.0 - 2014-07-08
* https://github.com/decipherinc/angular-debaser
* Copyright (c) 2014 Decipher, Inc.; Licensed MIT */

!function(a,b){"use strict";a.module("decipher.debaser",[]).constant("decipher.debaser.runConfig",b.$$config).config(["decipher.debaser.options","$logProvider","$provide",function(b,c,d){a.isFunction(c.debugEnabled)&&c.debugEnabled(b.debugEnabled),d.decorator("$log",["$delegate",function(b){return b.debug||a.noop}])}])}(window.angular,window.debaser),function(a){"use strict";a.module("decipher.debaser").factory("decipher.debaser.loadAction",function(){var b=function(b){a.extend(this,b)};return b.prototype.deserialize=function(){return function(){this.callback(this.object[this.func].apply(this.context,this.args))}.bind(this)},function(a){return a.actions.map(function(a){return new b(a)})}})}(window.angular),function(a){"use strict";a.module("decipher.debaser").factory("decipher.debaser.aspect",["decipher.debaser.superpowers","decipher.debaser.behavior",function(b,c){var d=function e(a,b){this.name=a,this.parent=b,this._id=e._id++};return d._id=0,d._DEFAULT_NAME="base",Object.defineProperties(d.prototype,{name:{get:function(){return this._name},set:function(a){this._dirty=this._isDirty(a,"_name"),this._name=a||d._DEFAULT_NAME}},parent:{get:function(){return this._parent},set:function(a){this._dirty=this._isDirty(a,"_parent"),this._parent=a}},proto:{get:function(){var a=this._dirty;return(!this._proto||a)&&this._initProto(),this._dirty=!1,this._proto},set:function(a){this._proto=a}},behavior:{get:function(){var a=this._dirty;return(!this._behavior||a)&&this._initBehavior(),this._dirty=!1,this._behavior},set:function(a){this._behavior=a}},config:{get:function(){return this.behavior.config},set:function(a){this.behavior.config=a}}}),d.prototype._initProto=function(){var c;(!this._proto||this._dirty)&&(c={},this.parent&&a.extend(c,this.parent.proto),a.forEach(b,function(a,b){"$"!==b.charAt(0)&&-1!==a.$aspect.indexOf(this._name)&&(c[b]=this.createProxy(a,b))},this),this._proto=c)},d.prototype._initBehavior=function(){(!this._behavior||this._dirty)&&(this._behavior=new c(a.extend(this._behavior||{},this.parent&&this.parent.isAspectOf(this.name)&&this.parent.behavior),this.name))},d.prototype.flush=function(){return this.behavior.flush()},d.prototype._isDirty=function(a,b){return a&&a!==this[b]||!a&&this[b]},d.prototype.createProxy=function(b,c){var d;return d=function(){var d,e,f=this.$$aspect,g=f.isAspectOf(c),h=this;return g||"base"===f.name||this.$enqueue(),d=this.$aspect(b.$name||c),e=b.apply(d.config,arguments),a.isArray(e)?d.behavior.enqueue(e):e&&(h=e),h}},d.prototype.createProxy.cache={},d.prototype.isAspectOf=function(a){return"base"!==a&&b[a]&&-1!==b[a].$aspect.indexOf(this.name)},d}])}(window.angular),function(a){"use strict";a.module("decipher.debaser").factory("decipher.debaser.behavior",["decipher.debaser.config",function(b){var c=function d(b,c){a.extend(this,b),this._aspect_name=c,this._id=d._id++};return c._id=0,c.prototype.enqueue=function(a){this.queue.push.apply(this.queue,a)},c.prototype.flush=function(){return this.queue.map(function(a){return a.deserialize()})},Object.defineProperties(c.prototype,{queue:{get:function(){return this._queue||(this._queue=[]),this._queue},set:function(a){this._queue=a||[]}},config:{get:function(){return this._config||(this._config=new b(this._aspect_name)),this._config},set:function(a){this._config=a||new b(this._aspect_name)}}}),c}])}(window.angular),function(a){"use strict";a.module("decipher.debaser").factory("decipher.debaser.config",function(){var b=function c(b,d){a.isString(b)?d=b:a.extend(this,b),this._aspect_name=d,this._callbacks=[],this._cb_idx=0,this._id=c._id++,this.actions=this.actions||[]};return b._id=0,b.prototype.addAction=function(b){if(!b)throw new Error("$debaser: addCall() expects call options");b.callback=b.callback||this.runner(),b.context=a.isDefined(b.context)?b.context:b.object||null,this.actions.push(b)},b.prototype.next=function(){this._callbacks[this._cb_idx]?this._callbacks[this._cb_idx++].apply(this,arguments):this.done()},b.prototype.done=function(){this._cb_idx=0},b.prototype.chain=function(a){this._callbacks.push(function(){this.next(a.apply(this,arguments))}.bind(this))},b.prototype.runner=function(){return function(){this.next.apply(this,arguments)}.bind(this)},b.prototype.isChained=function(){return!!this._callbacks.length},b})}(window.angular),function(a){"use strict";a.module("decipher.debaser").factory("decipher.debaser.debaser",["$log","decipher.debaser.aspect","decipher.debaser.options",function(b,c,d){var e=function f(c){a.isString(c)||(c=f.DEFAULT_NAME),this.$name=c,this.$queue=[],this.$aspect("base"),b(c!==f.DEFAULT_NAME?'$debaser: created Debaser instance with name "'+c+'"':"$debaser: created singleton Debaser instance")};return e.DEFAULT_NAME="__default__",e.prototype.$config=function(){return this.$$aspect.config},e.prototype.$aspect=function(b){var d,e,f=this.$$aspect;return a.isUndefined(b)&&(b=f.name),f&&(e=f.proto,Object.keys(e).forEach(function(a){delete this[a]},this)),d=new c(b,f),a.extend(this,d.proto),this.$$aspect=d,d},e.prototype.$enqueue=function(){var a=this.$$aspect;a&&this.$queue.push.apply(this.$queue,a.flush())},e.autoScopeProvider=function(a){a.decorator("$controller",["$rootScope","$delegate",function(a,b){return function(c,d){return d=d||{},d.$scope||(d.$scope=a.$new()),b(c,d),d.$scope}}])},e.autoScopeProvider.$inject=["$provide"],e.prototype.debase=function(){this.$enqueue(),this.$queue.forEach(function(a){a()}),this.$queue=[],this.$aspect("base"),d.autoScope&&a.mock.module(e.autoScopeProvider)},e}])}(window.angular),function(a,b){"use strict";var c={debugEnabled:!1,autoScope:!0,skipConfigs:!0},d=function(a){var d=function(d){d.constant("decipher.debaser.options",b.extend({},c,a))};return d.$inject=["$provide"],d},e=function(c,e){var f,g,h,i=a.debaser.$$debasers;return b.isObject(c)&&(e=c,c=null),!c&&i.__default__?i.__default__:(e=e||{},h=b.injector(["ng",d(e),"decipher.debaser"]),f=h.get("decipher.debaser.debaser"),c?(i[c]||(i[c]=new f(c)),i[c]):(i.__default__=g=new f,a.debase=g.debase.bind(g),b.mock.module(d(e),"decipher.debaser"),g))};e.$$debasers={},e.$$config={},a.debaser=e}(window,window.angular),function(a){"use strict";a.module("decipher.debaser").factory("decipher.debaser.superpowers",["decipher.debaser.loadAction","$window","decipher.debaser.runConfig","$log","decipher.debaser.options",function(b,c,d,e,f){var g,h,i,j,k,l,m,n=c.sinon,o=["create","resetBehavior","isPresent"],p=function(a){return"stub"===a.displayName||"spy"===a.displayName},q=function(a){return this.name&&this.stub&&a&&a.constant?a.constant(this.name,this.stub):void 0};g=function s(c,d){var e,g;if(c||(c="dummy-"+s.$id++),!a.isString(c))throw new Error("$debaser: module() expects a string");if(this.module=c,this.module_dependencies=[],d){if(!a.isArray(d))throw new Error("$debaser: module() expects array or undefined as second parameter");r.withDeps.call(this,d)}try{if(e=a.module(c),f.skipConfigs&&e)for(g=e._invokeQueue.length;g--;)"$injector"===e._invokeQueue[g][0]&&"invoke"===e._invokeQueue[g][1]&&e._invokeQueue.splice(g,1)}catch(h){}return e||this.addAction({object:a,func:"module",args:[this.module,this.module_dependencies]}),this.addAction({object:a.mock,func:"module",args:[this.module]}),b(this)},g.$aspect=["base"],g.$id=0,h=function(){return arguments.length?(Array.prototype.slice.call(arguments).forEach(function(b){if(!a.isString(b))throw new Error("$debaser: withDep() expects one or more strings")}),void this.module_dependencies.push.apply(this.module_dependencies,arguments)):e("$debaser: ignoring empty call to withDep()")},h.$aspect=["module"],i=function(b){if(!b)return e("$debaser: ignoring empty call to withDeps()");if(!a.isArray(b))throw new Error("$debaser: withDeps() expects an array");h.apply(this,b)},i.$aspect=["module"],j=function(b){var c=Array.prototype.slice.call(arguments,1);if(!b)return e("$debaser: ignoring empty call to func()");if(!a.isString(b))throw new Error("$debaser: func() expects a name");return this.func=n&&n.stub?n.stub.apply(n,c):function(){},k.call(this,b,this.func)},j.$aspect=["base"],k=function(c,f){if(!c)return e("$debaser: ignoring empty call to object()");if(!a.isString(c))throw new Error("$debaser: object() expects a name");if(f&&!a.isFunction(f)&&!a.isObject(f))throw new Error("$debaser: object() second param should be an Object or undefined");return this.stub||(a.isObject(f)||a.isFunction(f)||(f={}),this.stub=a.isObject(f)&&n&&n.stub&&!p(f)?n.stub(f):f),this.isChained()?void 0:(this.name=c,this.component="value",this.provider=function g(a,b){var c=b[g._id];a[c.component](c.name,c.stub)},this.provider.toString=function(){return this._id.toString()}.bind(this),this.provider._id=this._id,this.provider.$inject=["$provide","decipher.debaser.runConfig"],this.addAction({object:a.mock,func:"module",args:[this.provider]}),d[this._id]=this,b(this))},k.$aspect=["base"],l=function(b){var c=Array.prototype.slice.call(arguments,1);a.isObject(this.stub)?(this.func=n&&n.stub?n.stub.apply(n,c):function(){},this.stub[b]=this.func):(this.name=b,this.chain(q.bind(this)),j.apply(this,arguments))},l.$aspect=["module","object","withObject"],m=function(a){this.name=a,this.chain(q.bind(this)),k.apply(this,arguments)},m.$aspect=["module"];var r={func:j,module:g,object:k,withDep:h,withDeps:i,withFunc:l,withObject:m,$SINON_EXCLUDE:o};return a.forEach(r,function(a,b){a.$name||(a.$name=b)}),n&&a.forEach(n.stub,function(b,c){if(a.isFunction(b)&&-1===o.indexOf(c)){var d=function(){var a=b.apply(this.func,arguments);return a&&a.stub&&a.stub.func?(a.end=function(){return this}.bind(this),a):void 0};d.$aspect=["func","withFunc"],r[c]=d}}),r}])}(window.angular);
//# sourceMappingURL=debaser.min.js.map